# Startup settings
exec --no-startup-id setxkbmap -option ctrl:swapcaps
exec --no-startup-id python ~/.config/i3blocks/scripts/mouse disable
exec --no-startup-id feh --bg-fill ~/.config/i3/wallpaper
exec_always --no-startup-id python3 ~/.git/i3-app-list/src/i3_app_list.py 2>/tmp/app.log
exec_always --no-startup-id python3 ~/.config/i3/focus-last.py
exec --no-startup-id xset s off
exec --no-startup-id compton --vsync opengl --dbe

# set modifier key
set $mod Mod1
set $mod2 Mod4
floating_modifier $mod

# Font settings
font pango:ShureTechMono Nerd Font 0

# Misc
hide_edge_borders both
bindsym $mod+Return exec "st tmux"
bindsym $mod+q kill
bindsym $mod+f fullscreen toggle
# bindsym $mod2+l exec "i3lock-clock -p win -t -e -f -i ~/.config/i3/i3lock-img"
bindsym $mod2+l exec "i3lock-clock -p win -t -e -f -c 000000"
bindsym $mod+grave exec "python ~/.config/i3blocks/scripts/mouse toggle; pkill -RTMIN+2 i3blocks"

# Screenshot keybinds
## focused monitor only
bindsym Print exec scrot -q 100 'Screenshot from %Y-%m-%d %H-%M-%S.png' -e 'mv "$f" /home/ketan/Pictures'
## both monitors
bindsym Shift+Print exec scrot -q 100 -m 'Screenshot from %Y-%m-%d %H-%M-%S.png' -e 'mv "$f" /home/ketan/Pictures'

# remove borders for i3-gaps
for_window [class="^.*"] border pixel 4
new_window pixel 2


# Move workspaces between monitors
bindsym $mod+u move workspace to output right

# change focus
focus_follows_mouse no
mouse_warping none
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Choose split direction
bindsym $mod+Shift+backslash split h
bindsym $mod+Shift+minus split v

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+t layout tabbed
bindsym $mod+w layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle
bindsym $mod+space focus mode_toggle

# shift focus b/w parent & child
bindsym $mod+a focus parent
bindsym $mod+Shift+a focus child

# switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+Tab exec "python3 ~/.config/i3/focus-last.py --switch"

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1; workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2; workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3; workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4; workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5; workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6; workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7; workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8; workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9; workspace number 9

# reload/restart/exit i3
bindsym $mod+Shift+r reload
bindsym $mod+Shift+z exec "pkill -f ~/.config/i3/";restart
bindsym $mod+Shift+e exec "i3-msg exit"

# scratchpad
bindsym $mod+comma move scratchpad
bindsym $mod+period scratchpad show

# # dropdown terminal
# exec --no-startup-id st -n st-dropdown tmux
# for_window [instance="st-dropdown"] floating enable
# for_window [instance="st-dropdown"] move scratchpad; [instance="st-dropdown"] scratchpad show; move position 0px 22px resize shrink height 300px; resize grow width 683px; move scratchpad
# bindsym F6 [instance="st-dropdown"] scratchpad show

bindsym $mod+r mode "resize"
mode "resize" {
    # small shifts
    bindsym h resize shrink width 1 px or 1 ppt
    bindsym k resize grow height 1 px or 1 ppt
    bindsym j resize shrink height 1 px or 1 ppt
    bindsym l resize grow width 1 px or 1 ppt
    # big shifts
    bindsym Shift+h resize shrink width 10 px or 10 ppt
    bindsym Shift+k resize grow height 10 px or 10 ppt
    bindsym Shift+j resize shrink height 10 px or 10 ppt
    bindsym Shift+l resize grow width 10 px or 10 ppt
    # escape resize mode
    bindsym $mod+r mode "default"
    bindsym Escape mode "default"
    bindsym $mod+bracketleft mode "default"
}

bindsym $mod+m mode "monitor"
mode "monitor" {
    bindsym $mod+Shift+h exec "xrandr --output eDP1 --auto; xrandr --output HDMI2 --off;"
    bindsym $mod+Shift+l exec "xrandr --output HDMI2 --auto; xrandr --output eDP1 --off;"
    bindsym $mod+Shift+k exec "xrandr --output eDP1 --auto; sleep 2; xrandr --output HDMI2 --auto --right-of eDP1"

    bindsym $mod+m mode "default"
    bindsym Escape mode "default"
    bindsym $mod+bracketleft mode "default"
}

set $inner_gap 11
set $outer_gap 1
# add gaps
gaps inner $inner_gap
gaps outer $outer_gap

bindsym $mod+Shift+g mode "gaps"
mode "gaps" {
    bindsym $mod+0 gaps outer all set 0;  gaps inner all set 0;
    bindsym $mod+e gaps inner all set $inner_gap; gaps outer all set $outer_gap;
    bindsym $mod+i mode "gaps-inner"
    bindsym $mod+o mode "gaps-outer"
    bindsym Escape mode "default"
    bindsym $mod+bracketleft mode "default"
}

mode "gaps-inner" {
    bindsym $mod+plus gaps inner all plus 1;
    bindsym $mod+minus gaps inner all minus 1;
    bindsym $mod+equals gaps inner all set $inner_gap;
    bindsym Escape mode "gaps"
    bindsym $mod+bracketleft mode "gaps"
}

mode "gaps-outer" {
    bindsym $mod+plus gaps outer all plus 1;
    bindsym $mod+minus gaps outer all minus 1;
    bindsym $mod+equals gaps outer all set $outer_gap;
    bindsym Escape mode "gaps"
    bindsym $mod+bracketleft mode "gaps"
}

# colours
set $bg-color                   #ffffff
set $hl-bg-color                #333333
set $hl-fg-color                #9575cd
set $inactive-bg-color          #555555
set $inactive-border            #aaaaaa
set $text-color                 #222222
set $inactive-text-color        #444444
set $urgent-bg-color            #E53935
set $indicator-color            #00ff00
set $bar-bg-color               #ffffff33
set $bar-inactive-bg-color      #444444
set $bar-text-color             #ffffff
set $bar-inactive-text-color    #999999
set $active-border              #774077
set $bar-urgent-bg-color        #eeeeee
set $bar-urgent-text-color      #00afee
set $transparent                #00000000
set $red                        #ff4230
set $darkred                    #9b281b
set $orange                     #ffe533
set $darkorange                 #ffc523
set $yellow                     #ffe563
set $grey                       #777777
set $lightgrey                  #abb2bf
set $purple                     #8300ff
set $lightblue                  #48b8d6
set $blue                       #485eef
set $blackish                   #333333

# window colors
# element                border             background          text                   indicator
client.focused           $blue            $blue             $text-color            $blue
client.unfocused         $lightgrey         $lightgrey          #ffffff                $lightgrey
client.focused_inactive  $lightblue         $lightblue          #ffffff                $lightblue
client.urgent            $urgent-bg-color   $urgent-bg-color    $text-color            $bg-color

bar {
        i3bar_command i3bar -t
        mode dock
        position bottom
        tray_output primary
        font pango:TerminessTTF Nerd Font 11
        # separator_symbol " Â·"
        separator_symbol " "
        status_command i3blocks
        colors {
            background "#00000000"
            # separator #757575
            separator #00afee
            #                   border                  bg                       text
            focused_workspace   $blackish               $blackish                $yellow
            inactive_workspace  $blackish               $blackish                $grey
            active_workspace    $blackish               $blackish                $lightgrey
            urgent_workspace    $blackish               $bar-urgent-bg-color     $bar-urgent-text-color
            binding_mode        $blackish               $blackish                $bar-urgent-text-color
        }
}


# # toggle bar
# bindsym $mod+b bar mode toggle

# rename workspaces
# bindsym $mod+Shift+n exec python3 /home/ketan/.config/i3/rename_ws.py reorder
bindsym $mod+n exec i3-input -F 'rename workspace to "%s"' -P "workspace name: "

# run applications (rofi)
bindsym $mod+d exec rofi -show run
bindsym $mod+Shift+d exec i3-dmenu-desktop --dmenu='rofi -dmenu -p "Run: "'

# volume keybinds
bindsym $mod+minus exec "amixer -D pulse sset Master 5%-; pkill -RTMIN+2 i3blocks"
bindsym $mod+equal exec "amixer -D pulse sset Master 5%+; pkill -RTMIN+2 i3blocks"
bindsym $mod+0 exec "amixer -D pulse sset Master toggle; pkill -RTMIN+2 i3blocks"

# float experimental tk windows
for_window [class="^Tk$"] floating enable

# qtspim
for_window [class="^QtSpim$" title="^Console$"] floating enable, resize set 272 px 204 px, move position 3568 px 856 px
